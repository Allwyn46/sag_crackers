<div class="container mt-5">
  <div class="row">
    <div class="col-lg-12">
      <div class="table-responsive">
        <table class="table table-bordered w-full">
          <thead class="text-center">
            <tr>
              <th>S.No</th>
              <th colspan="3">Name Of the Product</th>
              <th>MRP Rate</th>
              <th>Discounted Price</th>
              <th colspan="7">Qty</th>
              <th>Price</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let item of products; let i = index">
              <!-- Category Row -->
              <tr *ngIf="item.type === 'category'" class="table-primary fw-bold">
                <td colspan="14">{{ item.name }}</td>
              </tr>

              <!-- Product Row -->
              <tr *ngIf="item.type === 'product'" class="text-center">
                <td>{{ getSerialNumber(i) }}</td>
                <td colspan="3">{{ item.name }}</td>
                <td style="text-decoration: line-through">{{ item.mrp }}</td>
                <td>{{ item.discount }}</td>
                <td colspan="7">
                  <input
                    type="text"
                    name="req-{{i}}"
                    [(ngModel)]="item.requirement"
                    (ngModelChange)="calculateFinalPrice(item,i)"
                    class="form-control text-center qty-input"
                    pattern="^[0-9]*$"
                    inputmode="numeric"
                    appDigitsonly
                    min="0"
                  />
                </td>
                <td>
                  <input
                    type="text"
                    class="form-control text-center qty-input"
                    [value]="productFinalPrices[i] || 0"
                    placeholder="Price"
                    disabled
                  />
                </td>
              </tr>
            </ng-container>
            <tr class="fw-bold table-secondary text-center">
              <td colspan="13" class="text-start">Grand Total</td>
              <td>{{ getGrandTotal() }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="row mb-5">
    <div class="col-lg-12 text-center">

<button
  type="button"
  class="btn btn-primary w-full"
  data-bs-toggle="modal"
  data-bs-target="#exampleModalcrack"
  [disabled]="!hasRequirement()"
>
  Place Order
</button>

    </div>
  </div>

</div>


<!-- Modal -->

<!-- Modal -->
<div
  class="modal fade"
  id="exampleModalcrack"
  tabindex="-1"
  aria-labelledby="exampleModalcrackLabel"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalcrackLabel">
          Order Summary
        </h1>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
        ></button>
      </div>
      <div class="modal-body">
        <table class="table table-bordered text-center">
          <thead>
            <tr>
              <th>S.No</th>
              <th>Product</th>
              <th>Qty</th>
              <th>Price</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let item of products; let i = index">
              <tr *ngIf="item.type === 'product' && item.requirement && +item.requirement > 0">
                <td>{{ getSerialNumber(i) }}</td>
                <td>{{ item.name }}</td>
                <td>{{ item.requirement }}</td>
                <td>{{ productFinalPrices[i] || 0 }}</td>
              </tr>
            </ng-container>
            <tr class="fw-bold table-secondary text-end">
              <td colspan="3">Grand Total</td>
              <td class="text-center">{{ getGrandTotal() }}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal"
        >
          Close
        </button>
        <button type="button" class="btn btn-primary" (click)="sendEmail()">Confirm Order</button>
      </div>
    </div>
  </div>
</div>


